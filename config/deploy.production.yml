# Deploy to these servers.
servers:
  web:
    - 45.79.198.65
  cron:
    hosts:
      - 45.79.198.65
    cmd:
      bash -c "(env && cat config/crontab) | crontab - && cron -f"
    options:
      user: root
  job:
    hosts:
      - 45.79.198.65
    cmd: bin/jobs

registry:
  # Specify the registry server, if you're not using Docker Hub
  # server: registry.digitalocean.com / ghcr.io / ...
  username: brincmafai

  # Always use an access token rather than real password when possible.
  password:
    - KAMAL_REGISTRY_PASSWORD

# Inject ENV variables into containers (secrets come from .kamal/secrets).
env:
  secret:
    - RAILS_MASTER_KEY
  clear:
    # Set Rails environment to production
    RAILS_ENV: production
    
    # Run the Solid Queue Supervisor inside the web server's Puma process to do jobs.
    # When you start using multiple servers, you should split out job processing to a dedicated machine.
    SOLID_QUEUE_IN_PUMA: true
